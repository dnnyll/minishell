# **************************************************************************** #
#                                                                              #
#                                                         :::      ::::::::    #
#    minishell_diagram.txt                              :+:      :+:    :+:    #
#                                                     +:+ +:+         +:+      #
#    By: daniefe2 <daniefe2@student.42lausanne.c    +#+  +:+       +#+         #
#                                                 +#+#+#+#+#+   +#+            #
#    Created: 2025/05/29 10:54:16 by daniefe2          #+#    #+#              #
#    Updated: 2025/05/29 11:46:47 by daniefe2         ###   ########.fr        #
#                                                                              #
# **************************************************************************** #







+----------------------------+
|        minishell.c         |
|----------------------------|
| 1. readline()              |
| 2. signal handling setup   |
| 3. call lexer(input)       |
+-------------+--------------+
              |
              v
+----------------------------+
|           lexer.c          |
|----------------------------|
| - Split input into tokens  |
|   (words, < > | " ' etc.)  |
| - Handles quotes           |
| - Creates a token list     |
|     [TOKEN][TOKEN][...]    |
+-------------+--------------+
              |
              v
+-----------------------------------+
|           parser.c                |
|-----------------------------------|
| - Syntax check                    |
| - Redirection syntax              |
| - Pipe detection                  |
| - Env var expansion ($VAR)        |
| - Produces command structs        |
|     e.g. t_cmd {args[], redir[]}  |
+-------------+---------------------+
              |
              v
+----------------------------+
|          executor.c        |
|----------------------------|
| - For each command         |
|   - Setup pipes/fork       |
|   - Apply redirections     |
|   - If builtin → call it   |
|   - Else → execve          |
| - Wait for children        |
+---+-------+---------+------+
    |       |         |
    v       v         v
+--------+ +---------+ +-------------+
|builtins| |  redirs | |  heredoc    |
|--------| |---------| |-------------|
| cd     | | > < >>  | | << handling |
| echo   | +---------+ +-------------+
| export |
| ...    |
+--------+

              |
              v
+-----------------------------+
|         signals.c           |
|-----------------------------|
| - SIGINT, SIGQUIT handling  |
| - Different behavior in:    |
|   - Prompt                  |
|   - Child process           |
+-----------------------------+

              |
              v
+----------------------------+
|           env.c            |
|----------------------------|
| - Build env list from envp |
| - Manage export/unset      |
| - Used in parser & exec    |
+----------------------------+

              |
              v
+----------------------------+
|        free_all.c          |
|----------------------------|
| - Frees:                   |
|   - Token list             |
|   - Command structs        |
|   - Env list (on exit)     |
+----------------------------+






+--------------------------------------------------------------+
|                        Minishell Flow                        |
+--------------------------------------------------------------+

                    +------------------+
                    |   readline()     |  ←⎯⎯⎯⎯⎯ Wait for user input
                    +--------+---------+
                             |
                             v
                    +--------+---------+
                    |      LEXER       |  ←⎯⎯⎯⎯⎯⎯ Tokenizes input
                    +--------+---------+
                             |
                             v
                    +--------+---------+
                    |      PARSER      |  ←⎯⎯⎯⎯ Builds AST or cmds
                    +--------+---------+
                             |
        +--------------------+--------------------+
        |                    |                    |
        v                    v                    v
+---------------+   +----------------+   +---------------------+
| Syntax Check  |   | Env Expansion  |   |   Heredoc Handling  |
+-------+-------+   +--------+-------+   +----------+----------+
        |                    |                     |
        +---------+----------+---------------------+
                  |
                  v
        +---------+---------+
        |     EXECUTOR      |  ←⎯⎯⎯ Runs commands/pipes/redirs
        +---------+---------+
                  |
       +----------+-----------+
       |                      |
       v                      v
+------------+        +------------------+
| Builtins   |        | External commands|
| (e.g. cd)  |        |   (execve fork)  |
+------------+        +------------------+

                  |
                  v
        +---------+---------+
        |   CLEANUP/FREE    |  ←⎯⎯⎯⎯ Frees memory, closes FDs
        +---------+---------+
                  |
                  v
        +-------------------+
        |  Return to prompt |
        +-------------------+

+--------------------------------------------------------------+
|                    Side Components (active anytime)          |
+--------------------------------------------------------------+

+------------------+    +------------------+    +------------------------+
|   signals.c      |    |     env.c        |    |     heredoc.c          |
| ---------------- |    | ---------------- |    | ---------------------- |
| - Handles SIGINT |    | - getenv/setenv  |    | - << delimiter input   |
| - Prompt vs exec |    | - export/unset   |    | - Temporary files      |
+------------------+    +------------------+    +------------------------+

